syntax = "proto3";

package erutan;

option java_multiple_files = true;
option java_package = "com.erutan";
option java_outer_classname = "Erutan";
option csharp_namespace = "Erutan.Scripts.Protos";
import "google/protobuf/timestamp.proto";

/*
    The Erutan service.
    Allows you to actually play the game.
*/
service Erutan {
    /*
    Blabla
    */
    rpc Stream(stream Packet) returns (stream Packet) {}
}

message Metadata {
    google.protobuf.Timestamp timestamp = 1;
}


message NetVector3 {
    float x = 1;
    float y = 2;
    float z = 3;
}

message NetQuaternion {
    float x = 1;
    float y = 2;
    float z = 3;
    float w = 4;
}

// TODO: parent ...
message NetObject {
    string object_id = 1;
    string owner_id = 2;
    NetVector3 position = 3;
    NetQuaternion rotation = 4;
    NetVector3 scale = 5;
    Type type = 6;
    enum Type {
        ANIMAL = 0;
        FOOD = 1;
        GROUND = 2;
    }
}


message Packet {
    Metadata metadata = 1;

    oneof type {
        CreateObjectPacket create_object = 2;
        UpdatePositionPacket update_position = 3;
        DestroyObjectPacket destroy_object = 4;
    }

    message CreateObjectPacket {
        NetObject object = 1; 
    }

    message UpdatePositionPacket {
        string object_id = 1;
        NetVector3 position = 2;
    }

    message DestroyObjectPacket {
        string object_id = 1;
    }
}
